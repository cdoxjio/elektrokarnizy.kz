<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MS-700 Certification Practice</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; }
    .mint-bg {
      background: linear-gradient(120deg, #e6fff4 0%, #f6fefc 100%);
    }
    .groups-link-bar {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 0.5em;
      margin: 2em auto;
      justify-items: center;
    }
    .group-link {
      padding: 0.4em 0.8em;
      border-radius: 6px;
      background: #E4EFFF;
      color: #3855A3;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
    }
    .group-link.active {
      background: #B22234;
      color: #fff;
    }
    .question-area {
      max-width: 1200px;
      margin: 0 auto;
      padding: 1em;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .options-list {
      list-style: decimal inside;
      margin-top: 1em;
    }
  </style>
</head>
<body class="mint-bg min-h-screen flex flex-col items-center">

  <header class="text-center p-6">
    <h1 class="text-3xl font-bold">MS-700 Certification Practice</h1>
    <nav class="groups-link-bar"></nav>
    <a href="#" class="random-link">Random Question</a>
  </header>

  <main class="question-area p-6 bg-white rounded-xl shadow-lg fade">
    <p class="question-text font-semibold"></p>
    <ul class="options-list"></ul>
    <a href="#" class="ask-again">Ask me another question</a>
  </main>

  <script>
    const QUESTIONS = [];
    let QUESTIONS_LOADED = false;
    let LOAD_ERROR = false;
    let groups = [];
    let currentGroupIndex = 0;
    let currentQuestionIndex = 0;

    // Fetch questions and shuffle answers only
    fetch('ms700_questions.json')
      .then(r => r.json())
      .then(qs => {
        QUESTIONS.push(...qs.map(q => {
          const correctAnswer = q.answers[0];
          const shuffledAnswers = shuffle([...q.answers]);
          const correctIndex = shuffledAnswers.indexOf(correctAnswer);

          return {
            ...q,
            answers: shuffledAnswers,
            correct: correctIndex
          };
        }));
        QUESTIONS_LOADED = true;
        start();
      })
      .catch(() => {
        LOAD_ERROR = true;
        render();
      });

    // Shuffle function to randomize answers
    function shuffle(array) {
      let a = array.slice();
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    // Split questions into groups of 20
    function chunkArray(array, size) {
      const result = [];
      for (let i = 0; i < array.length; i += size) {
        result.push(array.slice(i, i + size));
      }
      return result;
    }

    // Start the application
    function start() {
      groups = chunkArray(QUESTIONS, 20); // Groups of 20 questions
      render();
    }

    // Render the navigation links for groups
    function render() {
      if (LOAD_ERROR) {
        document.getElementById('app').innerHTML = 'Error loading questions.';
        return;
      }
      if (!QUESTIONS_LOADED) {
        document.getElementById('app').innerHTML = 'Loading...';
        return;
      }

      let nav = '<nav class="groups-link-bar">';
      groups.forEach((group, idx) => {
        nav += `<button class="group-link" onclick="showGroup(${idx})">Group ${idx + 1}</button>`;
      });
      nav += '</nav>';

      document.getElementById('app').innerHTML = nav + '<div id="question-container"></div>';
      showGroup(0);
    }

    // Show questions from a specific group
    function showGroup(groupIdx) {
      currentGroupIndex = groupIdx;
      currentQuestionIndex = 0;
      const group = groups[groupIdx];
      let questionHtml = '';
      group.forEach((q, idx) => {
        questionHtml += `<div class="question-area p-4 bg-white rounded shadow my-2">`;
        questionHtml += `<p class="font-semibold">${idx + 1}. ${q.question}</p><ul>`;
        q.answers.forEach((ans, ansIdx) => {
          const optionLetter = String.fromCharCode(65 + ansIdx); // A, B, C, D...
          questionHtml += `<li>${optionLetter}. ${ans}</li>`;
        });
        questionHtml += `</ul></div>`;
      });
      document.getElementById('question-container').innerHTML = questionHtml;
    }

  </script>

</body>
</html>
