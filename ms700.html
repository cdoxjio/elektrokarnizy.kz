<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The MS-700 certification</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; }
    .fade { transition: all 0.5s; }
    .question-area { max-width: 1200px; margin: 0 auto; }
    .question-area p { margin-bottom: 0.7em; }
    .mint-bg {
      background: linear-gradient(120deg, #e6fff4 0%, #f6fefc 100%);
    }
    .groups-link-bar {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
      gap: 0.5em;
      justify-items: center;
      align-items: center;
      margin-bottom: 0.1em;
      margin-top: 2em;
    }
    .group-link {
      padding: 0.1em 0.7em;
      border-radius: 6px;
      font-size: 1em;
      text-decoration: underline dotted;
      color: #205070;
      background: none;
      border: none;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
      outline: none;
      user-select: none;
      font-family: 'Segoe UI', Arial, sans-serif;
      font-weight: 600;
    }
    .group-link.active {
      color: #fff;
      background: #B22234;
      text-decoration: none;
      font-weight: bold;
    }
    .group-link:focus-visible {
      outline: 2px solid #B22234;
      outline-offset: 1px;
    }
    .random-link {
      padding: 0.1em 0.7em;
      border-radius: 6px;
      font-size: 1em;
      color: #137ca8;
      text-decoration: underline dotted;
      cursor: pointer;
      font-weight: 600;
      letter-spacing: 0.01em;
      background: none;
      border: none;
      margin-top: 0.7em;
      margin-bottom: 1em;
      margin-left: 0.3em;
      margin-right: 0.3em;
      font-family: 'Segoe UI', Arial, sans-serif;
      transition: color 0.15s;
      display: inline-block;
    }
    .random-link:hover { color: #1e80c1; }
    /* ... (остальные стили без изменений) ... */
  </style>
</head>
<body class="mint-bg min-h-screen flex flex-col items-center">
  <div id="app" class="w-full flex flex-col items-center justify-center min-h-screen"></div>
  <div id="footerInfo"></div>
<script>
const QUESTIONS = [];
let QUESTIONS_LOADED = false;
let LOAD_ERROR = false;
let allQuestionsMode = false;

fetch('ms700_questions.json')
  .then(r => r.json())
  .then(qs => { QUESTIONS.push(...qs); QUESTIONS_LOADED = true; start(); })
  .catch(() => {
    LOAD_ERROR = true;
    render();
  });

function chunkArray(array, size) {
  // Возвращает только те чанки (группы), которые НЕ пустые
  const result = [];
  for (let i = 0; i < array.length; i += size) {
    const chunk = array.slice(i, i + size);
    if (chunk.length > 0) result.push(chunk);
  }
  return result;
}
function shuffle(arr) {
  let a = arr.slice();
  for (let i = a.length - 1; i > 0; i--) {
    let j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}
const ABC = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
let groupIdx = 0, qIdx = 0, showAnswer = false, groupResults = [], timer = 0, timeActive = true;
let interval = null, groups = [], group = [], q = {};
let allSelected = [];
let retryMode = false;

// Фильтруем только валидные вопросы!
function getValidQuestions() {
  return shuffle(QUESTIONS).filter(q =>
    q && (q.text || q.question) &&
    ((q.options && Array.isArray(q.options) && q.options.length) ||
     (q.answers && Array.isArray(q.answers) && q.answers.length))
  ).map(q => ({
    text: q.text || q.question,
    options: q.options || q.answers,
    correct: q.correct || []
  }));
}

// ИСПРАВЛЕНИЕ: формируем только непустые группы
function start() {
  allQuestionsMode = false;
  const validQuestions = getValidQuestions();
  groups = chunkArray(validQuestions, 20);
  groupIdx = 0;
  goToGroup(0);
}

function startAllQuestionsRandom() {
  allQuestionsMode = true;
  groups = [getValidQuestions()];
  groupIdx = 0;
  goToGroup(0);
}

// ... (дальше остальной код файла остается без изменений) ...

// Ниже можно вставить остальные функции из вашего текущего файла, они не затрагивают логику групп.

</script>
</body>
</html>
